= Calling {sqlpp} from Javascript

:description: Executing N1QL statements from Javascript user-defined functions.
:page-pagination: 
:page-topic-type: guide
:page-toclevels: 2

[.edition]#{enterprise}#
[abstract]
{description}

== Introduction

As well as being able to call Javascript functions from N1QL, you can also call N1QL statements from inside your Javascript functions.

[#calling-statements-inline]
== Calling {sqlpp} statements inline

You can embed an {sqlpp} statement directly in your Javascript code:

[source,javascript]
----
include::example$javascript-udfs/add-airline-inline-call.js[]
----

== Executing {sqlpp} statements with using the N1QL() call

In addition to the inline call, you can also execute an {sqlpp} statement by calling it from the `N1QL(â€¦)` function.
[source, javascript]
----
include::example$javascript-udfs/add-airline-n1sql-call.js[]
----

NOTE: Behind the scenes, the inline call method will generate the equivalent `N1QL` call, so whichever you choose to use will come down to personal preference.

== Returning values from {sqlpp} statements

As shown in the <<calling-statements-inline, examples above>>, embedded {sqlpp} statements  return values which can be used later on in your code.

The values returned from the statement calls are Javascript https://www.w3schools.com/js/js_object_iterables.asp[iterators^]: lists of values or documents returned from the database. In the next example, we're going to retrieve a list of the hotels stored in the `travel-sample` database:

[source, javascript]
----
include::example$javascript-udfs/select-hotels.js[]
----

<.> The inline {sqlpp} statement returns an iterator containing the items retrieved by the query.
<.> Using the standard Javascript iterator pattern to loop through the items returned in `q`.
<.> Add the iterator's current document to the result array `res`.
<.> Once alll the items have been retrieved, return the the result array.


== Passing Parameters to {sqlpp} statements

Either positional or named parameters can be used in embedded {sqlpp} statements:


== Further Reading

// TODO: Add link for Marco's blog entry


