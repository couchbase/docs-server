//tag::javascript-udf-multiple-references[]
[mermaid, subs="attributes"]
----
flowchart
    slqpp1("N1QL: MyAdd(2,2)")   
    slqpp2("N1QL: AnotherAdd(2,2)") 
    subgraph MyLibrary
      jfunction("javascript: add(2,2)")
    end
    
    slqpp1 --references--> jfunction
    slqpp2 --references--> jfunction
----
//end::javascript-udf-multiple-references[]


//tag::javascript-udf-inline-call-sequence[]
[mermaid, subs="attributes"]
----
sequenceDiagram
    actor Dev
    participant JSEngine
    participant Query as Query Engine
    participant Bucket
    
    Dev ->> JSEngine: JS: var q = select …
    activate JSEngine
    JSEngine ->> Query : N1QL(…) call
    activate Query
    Query ->> JSEngine  : return query
    deactivate Query
    JSEngine ->> Dev : return q
    deactivate JSEngine
    
    loop Every document in q
    
       Dev ->>+ JSEngine : operate on document
       JSEngine ->>+ Query : get document
       Query ->>+ Bucket: get document
       Bucket ->>- Query : retrieved document
       Query ->>- JSEngine : retrieved document
    end
----
//end::javascript-udf-inline-call-sequence[]

//tag::javascript-udf-data-transformation[]
[mermaid, subs="attributes"]
----
flowchart LR
   runStatement[Run N1QL statement] 
   transformData[Transform JSON data]
   returntransformedData([Return])
   
   runStatement--"{item1, item2, item3}"-->transformData
   transformData--"{item1, item3}"-->returntransformedData
----
//end::javascript-udf-data-transformation[]
