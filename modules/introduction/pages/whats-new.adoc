= What's New in Version 6.5 Beta?
:page-aliases: security:security-watsnew

Couchbase Server 6.5 Beta brings many sought-after relational capabilities to the NoSQL world. This release seeks to improve developer agility, reduce total cost of ownership, enhance manageability, and provide more enterprise-grade security and performance.

include::ROOT:partial$beta-disclaimer.adoc[tag=admonition]

This release also introduces the Developer Preview mode, which provides early access to features which may be GA in a future release. Interested to learn more about the Preview mode and play with these features in development? See xref:developer-preview:preview-mode.adoc[Developer Preview Mode and Features] for details.


[#new-features]
== New Features and Enhancements

=== Unmatched Agility and Flexibility

This release brings many sought-after relational capabilities to application developers - distributed ACID transactions, advanced query capabilities like window functions, index advisor, cost-based optimizer, eventing enhancements, and major updates to SDKs, to name a few. 

==== Distributed ACID Transactions

With distributed ACID transactions, application developers can simplify their application logic by relying on all-or-nothing semantics from Couchbase for durably modifying multiple documents distributed on different nodes. Replicas are immediately consistent with the transaction commit while indexes and cross datacenter replication (XDCR) are eventually consistent with the transaction commit. Read committed isolation is provided for concurrent readers. Durability is provided at three different levels: replicate to majority of the nodes; replicate to majority and persist to disk on primary; or persist to disk on majority of the nodes.

Couchbase transactions are architected to provide ACID guarantees at scale while ensuring there are no single points of failure or performance bottlenecks. 

For more information, see xref:learn:data/distributed-acid-transactions.adoc[Distributed ACID Transactions].

==== SDK 3.0 Alpha Releases

Couchbase SDKs are bringing in major new features and updating interfaces to the latest for the platform. They support many new features available in this Server release while ensuring compatibility with older releases. 

==== Query Enhancements

This release packs numerous additions to the Query service and N1QL to provide a comprehensive query development toolkit for building applications. 

===== Window Functions

RDBMS ANSI standard equivalent window functions are introduced in Couchbase to simplify complex queries like financial and statistical reporting to intuitive N1QL constructs.

Window functions are used to compute an aggregate or cumulative value, based on a group of objects. The objects are not grouped into a single output object — each object remains separate in the query output.

For more information, see xref:n1ql:n1ql-language-reference/windowfun.adoc[Window Functions].

===== Common Table Expressions (CTE)

Couchbase CTE is yet another ANSI CTE equivalent to enhance the manageability of complex queries where the developer can isolate the SQL statement into a temporary named result set which can be referenced as a source table in the context of a larger query. 

For more information, see xref:n1ql:n1ql-language-reference/with.adoc[WITH Clause].

===== Query and Search Integration

Couchbase’s powerful full-text search capability is now fully integrated with N1QL. The feature extends N1QL search functionality with fuzzy and non-exact text searches across multiple fields and any order. By enabling developers to use full-text search queries directly within a N1QL query, it eliminates the need to write complex code to process and combine the results from separate SQL and search queries.

For more information, see xref:n1ql:n1ql-language-reference/searchfun.adoc[Search Functions].

===== Cost Based Optimizer (Developer Preview)

Couchbase is delivering the well-known cost-based optimizer, deriving access patterns based on statistical data for query tuning to the NoSQL world. This feature aids developers by eliminating the time spent on tweaking a query using a rule-based optimizer to choose the most optimal execution plan. 

===== Index Advisor (Developer Preview)

Index advisor is yet another valuable addition to the Couchbase tooling portfolio where index suggestions are provided to optimize query tuning and improve the performance of the queries. Running workloads are monitored and analyzed to suggest appropriate indexes for improving response times.

For more information, see xref:n1ql:n1ql-language-reference/advise.adoc[ADVISE Statement]

===== User-defined Functions (Developer Preview)

The most loved stored procedures of the relational world are back as user-defined functions with N1QL. JavaScript ninjas can use their skills to define the functions centrally, which can in turn be leveraged by several applications or microservices. This will provide better management of complex logic and application performance. 

For more information, see xref:n1ql:n1ql-language-reference/userfun.adoc[User-Defined Functions].

==== Eventing Enhancements

Couchbase Functions now supports native cURL that lets users propagate events to other APIs when mutation rates are low. The source bucket could be updated from inside the Function which lets developers write applications that need inline data enrichment capabilities. Also, other bucket operations, like sub-document changes, could be performed from within the Function. By leveraging ‘From Prior’ as a feed boundary, Couchbase Functions could be undeployed, edited, and redeployed without losing a single mutation; continuity is maintained. Version history of the deployed Function is available and lets customers keep track of changes to the Function.

=== Unparalleled Performance at Any Scale

==== More Buckets per Cluster

Buckets in Couchbase provide physical, logical, and access isolation. Starting with version 6.5, we provide the ability to create up to 30 buckets in a single cluster, which will bolster the opportunities for supporting multi-tenancy and microservices-based applications with improved resource utilization. 

For more information, see xref:manage:manage-buckets/create-bucket.adoc[Create a Bucket].

==== Collections

As a step to drive the migration from relational to NoSQL seamlessly, collections are introduced to allow applications to structure their data by keeping similar documents together, just like tables do in relational databases. Further, related collections can be held together in a single scope. With collections and scopes, application developers will find it much easier to migrate their schemas and data to Couchbase from relational systems like Oracle and SQL Server, as well as translate their SQL queries to Couchbase N1QL. Collections and scopes can be individually access controlled, hence also enabling many microservices and/or applications to share a single Couchbase database (bucket). 

For more information, see xref:developer-preview/collections/collections-overview.adoc[Collections Overview].

==== Scan Consistency in Analytics

With scan consistency in Analytics, cluster operations like rebalance and failover will not affect the business-critical reports and dash-boards that are being used to glean insights and drive business decisions.

For more informaiton, see xref:analytics/query-params.adoc[Query Parameters].

==== Advanced Filtering in XDCR

XDCR’s advanced filtering provides the capability to build filters based on document attributes such as keys, values, and Xattrs with a N1QL-like syntax. We also offer the flexibility to modify the filters dynamically for ongoing replication to ensure users only replicate the data relevant to their business needs at any point during the replication.

For more information, see xref:learn:clusters-and-availability/xdcr-filtering.adoc[Advanced Filtering in XDCR].

==== Quality of Service for XDCR

XDCR’s Quality of Service feature enables administrators to prioritize on-going replication streams over the initial replication to ensure the replications are serviced in the order of criticality. Priorities assigned will dictate the quality of service for every replication stream and enable efficient resource utilization.

For more information, see xref:learn:clusters-and-availability/xdcr-overview.adoc[XDCR Priority].

=== Ease of Platform Manageability 

==== Robust Rebalance

Rebalance is now much more robust and resilient, enabling Couchbase administrators to automate management of their cluster rebalance. Some of the improvements include automatic restart of rebalance after failure, automatic rebalance after node failover, and enhanced monitoring of rebalance progress.

For more information, see xref:learn:clusters-and-availability/rebalance.adoc[Rebalance Overview].

==== Node to node Encryption

Couchbase Server continues to extends its security capabilities to meet stringent security and regulatory compliance requirements. Node-to-node encryption adds an additional layer of security by encrypting data in transit between cluster services which are deployed across servers. This prevents potential attackers from intercepting sensitive intra-cluster traffic. 

For more information, see xref:learn:clusters-and-availability/node-to-node-encryption.adoc[Node-to-Node Encryption].

==== LDAP Group Support

With group support, you can leverage existing organizational groups in your LDAP domain to control Couchbase Server access. In addition, user groups can also be configured for local domain users to better manage and control which Couchbase resources are accessed. Groups can be mapped to real-life development teams, business units, or departments.

For more information, see xref:learn:security/authentication-overview.adoc[Authentication].

==== TLS Cipher Configuration

With security becoming more and more important than ever, hardening your servers and removing older or weak cipher suites is becoming a major priority for many organizations. Couchbase Server provides a consistent approach to modify TLS cipher suites and settings across services, , which persists across server upgrades and restarts. 

For more information, see xref:learn:security/encryption-overview[Encryption].

=== Backup and Recovery

Significant improvements are made to backup and recovery in terms of performance, storage, and scalability. 

==== Improved Backup Performance 

Improved performance (rate of backup & restore) with backup has been the most requested factor to be adopted as an enterprise grade tool. In order to improve the performance, we made some fundamental changes to the tool. Some of these improvements include leveraging value compression on the server, replacement of storage engine, modifying the storage format, limiting the size of the backup file, metadata isolation etc.,  
This has resulted in significant improvement in various backup functionalities such as full backup, incrementals, merge, list etc., and also the scalability for datasets in the range of single digit TBs.
Based on our internal testing, we observe ~4x improvement compared to the previous versions of backup.

==== Storage
Historically, backup was stored as one big file which at times led to the need for ~20-30% more storage compared to the size of the original dataset especially for merge operations. With the changes made to the storage engine, compression, file formats and metadata isolation, the required storage is reduced to ~40% of the original dataset.

==== Info Command (Developer Preview)
A new  “info” command is introduced to provide a detailed listing of the backup files with information on the type of backup such as full, incremental, merge, number of views, indexes, FTS indexes, indication of backup completion etc., in addition to the repositories and their sizes.We have also added the option to output a JSON document which can be used for any automation purpose.

==== Measuring Consistency (Developer Preview)

Since Couchbase Server is a completely distributed database there is some time elapse between data distributed across nodes. With 6.5, we are providing the ability to measure this consistency for backups. To attain maximum consistency, a full backup can be run, followed by small incrementals to make up for the delta. “Disk-only” mode is used where the documents persisted to the disk are backed up which provides better consistency across vBuckets. 

=== Other Enhancements

==== Advanced UI Statistics

Unique service-specific stats are made available in the UI to assist with troubleshooting. These stats are updated with a new charting framework which enables users to completely customize them, with features such as the ability to select time ranges, sizes for display, aggregation across multiple nodes, edit, drag, drop, and more.

For more information, see xref:manage:monitor/ui-monitoring-statistics.adoc[Monitor with the UI].



