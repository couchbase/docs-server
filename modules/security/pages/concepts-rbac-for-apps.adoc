= RBAC for Applications
:page-aliases: concepts-rbac-for-apps,concepts-rba-for-apps

[abstract]
Role-Based Access Control precisely determines an application's ability to read and write data.

== Roles and Privileges

Couchbase _roles_ each have a fixed association with a set of one or more privileges.
Each privilege is associated with a resource.
Privileges are actions such as *Read*, *Write*, *Execute*, *Manage*, *Flush*, or *List*; or a combination of some or all of these.

When an application attempts to access a resource, the application's roles and privileges are checked by Couchbase Server.
If the assigned roles contain privileges that support the kind of access that is being attempted, access is granted; otherwise, it is denied.

The following list contains all application-roles supported by Couchbase RBAC.
Each role explained by means of a description and a table: the table lists the privileges in association with resources.
Where a privilege is associated with a resource, this is indicated with a check-mark.
Where a privilege is not associated with a resource (or where association would not be applicable), this is indicated with a cross.

== Access to Couchbase Web Console

Only a subset of application-roles are granted access to the Couchbase Web Console.
In the tables below, if a *UI* row is included, the role is granted the UI-related privilege indicated in the row, and the username and password associated with the role can therefore be used to log into the console.
If no *UI* row is included, no UI-related privilege is granted; and the username and password cannot therefore be used to log into the console.

== Bucket Full Access

The *Bucket Full Access* role provides full access to bucket data.
Note that this privilege is available for the Community Edition of Couchbase Server, as well as for Enterprise Edition.

The role is provided in support of buckets that were created on versions of Couchbase Server prior to 5.0.
Such buckets were accessed by specifying _bucket-name_ and _bucket-password_: however, bucket-passwords are not recognized by Couchbase Server 5.0 and after.
Therefore, for each pre-existing bucket, the 5.0 upgrade-process creates a new user, whose username is identical to the bucket-name; and whose password is identical to the former bucket-password, if one existed.
If no bucket-password existed, the user is created with no password.
This migration-process allows the same name-combination as before to be used in authentication.
To ensure backwards compatibility, each system-created user is assigned the [.ui]*Bucket Full Access* role, which authorizes the same read-write access to bucket-data as was granted before 5.0.

Use of the [.ui]*Bucket Full Access* role is deprecated for buckets created on Couchbase Server 5.0 and after: use the other bucket-access roles provided.

NOTE: The tables below list each bucket's *name* followed by its `alias name` in parenthesis.
The `alias names` are used in commands and are accessible only by N1QL queries.

[#table_bucket_full_access_role,cols="15,8,8,8,8,8",hrows=3]
|===
6+^| Role: Bucket Full Access (`bucket_full_access`)

.2+^h| Resources
5+^h| Privileges

^h| *Read*
^h| *Write*
^h| *Execute*
^h| *Manage*
^h| *Flush*

^| Bucket [ * {vbar} _bucket-name_ ]: Data
^| image:introduction/yes.png[]
^| image:introduction/yes.png[]
^| image:introduction/yes.png[]
^| image:introduction/yes.png[]
^| image:introduction/no.png[]

^| Bucket [ * {vbar} _bucket-name_ ]: Views
^| image:introduction/yes.png[]
^| image:introduction/yes.png[]
^| image:introduction/yes.png[]
^| image:introduction/yes.png[]
^| image:introduction/no.png[]

^| N1QL: Index
^| image:introduction/yes.png[]
^| image:introduction/yes.png[]
^| image:introduction/yes.png[]
^| image:introduction/yes.png[]
^| image:introduction/no.png[]

^| N1QL: Other
^| image:introduction/yes.png[]
^| image:introduction/yes.png[]
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Bucket: [ * {vbar} _bucket-name_ ]
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/yes.png[]

^| Pools
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
|===

== Data Reader

The *Data Reader* role allows data to be read from a specified bucket.
Note that the role does _not_ permit the running of N1QL queries (such as SELECT) against data.

[#table_data_reader_role,cols="15,8,8,8,8",hrows=3]
|===
5+^| Role: Data Reader (`data_reader`)

.2+^h| Resources
4+^h| Privileges

^h| *Read*
^h| *Write*
^h| *Execute*
^h| *Manage*

^| Bucket [ * {vbar} _bucket-name_ ]: Docs
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Bucket [ * {vbar} _bucket-name_ ]: Meta
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Bucket [ * {vbar} _bucket-name_ ]: Xattr
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Pools
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
|===

== Data Writer

The *Data Writer* role allows information to be written to and read from a specified bucket.

[#table_data_writer_role,cols="15,8,8,8,8",hrows=3]
|===
5+^| Role: Data Writer (`data_writer`)

.2+^h| Resources
4+^h| Privileges

^h| *Read*
^h| *Write*
^h| *Execute*
^h| *Manage*

^| Bucket [ * {vbar} _bucket-name_ ]: Docs
^| image:introduction/yes.png[]
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Bucket [ * {vbar} _bucket-name_ ]: Xattr
^| image:introduction/yes.png[]
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Pools
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
|===

== Data DCP Reader

The *Data DCP Reader* role allows DCP streams to be read.

[#table_data_dcp_reader_role,cols="2,1,1,1,1",hrows=3]
|===
5+^| Role: Data DCP Reader (`data_dcp_reader`)

.2+^h| Resources
4+^h| Privileges

^h| *Read*
^h| *Write*
^h| *Execute*
^h| *Manage*

^| Bucket: [ * {vbar} _bucket-name_ ]: Docs
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Bucket: [ * {vbar} _bucket-name_ ]: Meta
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Bucket: [ * {vbar} _bucket-name_ ]: DCP
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Bucket: [ * {vbar} _bucket-name_ ]: Sxattr
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Bucket: [ * {vbar} _bucket-name_ ]: Xattr
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Admin: Memcached: Idle
^| image:introduction/no.png[]
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Pools
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
|===

== Data Backup

The *Data Backup* role allows data to be backed up and restored.

[#table_data_backup_role,cols="15,8,8,8,8",hrows=3]
|===
5+^| Role: Data Backup (`data_backup`)

.2+^h| Resources
4+^h| Privileges

^h| *Read*
^h| *Write*
^h| *Execute*
^h| *Manage*

^| Bucket: [ * {vbar} _bucket-name_ ]: Data
^| image:introduction/yes.png[]
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Bucket: [ * {vbar} _bucket-name_ ]: Views
^| image:introduction/yes.png[]
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Bucket: [ * {vbar} _bucket-name_ ]: FTS
^| image:introduction/yes.png[]
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/yes.png[]

^| Bucket: [ * {vbar} _bucket-name_ ]: Stats
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Bucket: [ * {vbar} _bucket-name_ ]: Settings
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Bucket: [ * {vbar} _bucket-name_ ]: Pools
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
|===

== Data Monitoring

The *Data Monitoring* role allows all bucket-statistics to be read.

[#table_data_monitoring_role,cols="15,8,8,8,8",hrows=3]
|===
5+^| Role: Data Monitoring (`data_monitoring`)

.2+^h| Resources
4+^h| Privileges

^h| *Read*
^h| *Write*
^h| *Execute*
^h| *Manage*

^| Bucket [ * {vbar} _bucket-name_ ]: Stats
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Pools
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
|===

== Views Reader

The *Views Reader* role allows all views to be read.

[#table_views_reader_role,cols="15,8,8,8,8",hrows=3]
|===
5+^| Role: Views Reader (`views_reader`)

.2+^h| Resources
4+^h| Privileges

^h| *Read*
^h| *Write*
^h| *Execute*
^h| *Manage*

^| Bucket [ * {vbar} _bucket-name_ ]: Data
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Bucket [ * {vbar} _bucket-name_ ]: Views
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
|===

== FTS Searcher

The role *FTS Searcher* allows _Full Text Search_ indexes to be searched by users with appropriate bucket-privileges.

[#table_fts_searcher_role,cols="15,8,8,8,8",hrows=3]
|===
5+^| Role: FTS Searcher (`fts_searcher`)

.2+^h| Resources
4+^h| Privileges

^h| *Read*
^h| *Write*
^h| *Execute*
^h| *Manage*

^| Bucket [ * {vbar} _bucket-name_ ]: FTS
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Settings: FTS
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| UI
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Pools
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
|===

== Query Select

The *Query Select* role allows the SELECT statement to be executed on a specified bucket.

[#table_query_select_role,cols="15,8,8,8,8",hrows=3]
|===
5+^| Role: Query Select (`query_select`)

.2+^h| Resources
4+^h| Privileges

^h| *Read*
^h| *Write*
^h| *Execute*
^h| *Manage*

^| Bucket [ * {vbar} _bucket-name_ ]: N1QL, SELECT
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/yes.png[]
^| image:introduction/no.png[]

^| UI
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Pools
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
|===

== Query Update

The *Query Update* role allows the UPDATE statement to be executed on a specified bucket.

[#table_query_update_role,cols="15,8,8,8,8",hrows=3]
|===
5+^| Role: Query Update (`query_update`)

.2+^h| Resources
4+^h| Privileges

^h| *Read*
^h| *Write*
^h| *Execute*
^h| *Manage*

^| Bucket [ * {vbar} _bucket-name_ ]: N1QL, UPDATE
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/yes.png[]
^| image:introduction/no.png[]

^| UI
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Pools
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
|===

== Query Insert

The *Query Insert* role allows the INSERT statement to be executed on a specified bucket.

[#table_query_insert_role,cols="15,8,8,8,8",hrows=3]
|===
5+^| Role: Query Insert (`query_insert`)

.2+^h| Resources
4+^h| Privileges

^h| *Read*
^h| *Write*
^h| *Execute*
^h| *Manage*

^| Bucket [ * {vbar} _bucket-name_ ]: N1QL, INSERT
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/yes.png[]
^| image:introduction/no.png[]

^| UI
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Pools
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
|===

== Query Delete

The *Query Delete* role allows the DELETE statement to be executed on a specified bucket.

[#table_query_delete_role,cols="15,8,8,8,8",hrows=3]
|===
5+^| Role: Query Delete (`query_delete`)

.2+^h| Resources
4+^h| Privileges

^h| *Read*
^h| *Write*
^h| *Execute*
^h| *Manage*

^| Bucket [ * {vbar} _bucket-name_ ]: N1QL, DELETE
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/yes.png[]
^| image:introduction/no.png[]

^| UI
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Pools
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
|===

== Query Manage Index

The *Query Manage Index* role allows indexes to be managed for a specified bucket.

[#table_query_manage_index_role,cols="15,8,8,8,8",hrows=3]
|===
5+^| Role: Query Manage Index (`query_manage_index`)

.2+^h| Resources
4+^h| Privileges

^h| *Read*
^h| *Write*
^h| *Execute*
^h| *Manage*

^| Bucket [ * {vbar} _bucket-name_ ]: N1QL, INDEX
^| image:introduction/yes.png[]
^| image:introduction/yes.png[]
^| image:introduction/yes.png[]
^| image:introduction/yes.png[]

^| UI
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Pools
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
|===

== Query System Catalog

The *Query System Catalog* role allows information to be looked up in the system catalog: this includes `system:indexes`, `system:prepareds`, and tables listing current and past queries.
This role is designed for troubleshooters, who need to debug queries.

[#table_query_system_catalog_role,cols="15,8,8,8,8,8",hrows=3]
|===
6+^| Role: Query System Catalog (`query_system_catalog`)

.2+^h| Resources
5+^h| Privileges

^h| *Read*
^h| *Write*
^h| *Execute*
^h| *Manage*
^h| *List*

^| Bucket [ * {vbar} _bucket-name_ ]: N1QL, INDEX
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/yes.png[]

^| Bucket [ * {vbar} _bucket-name_ ]: N1QL, Meta
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| UI
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Pools
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
|===

== Query External Access

The *Query External Access* role allows the N1QL CURL function to be executed by an externally authenticated user.

Note that the *Query External Access* role should be assigned with caution, since it entails risk: CURL runs within the local Couchbase Server network; therefore, the assignee of the *Query External Access* role is permitted to run GET and POST requests on the internal network, while being themselves externally located.

For an account of limitations on CURL, see xref:n1ql:n1ql-language-reference/curl.adoc[CURL Function].

[#table_query_external_access_role,cols="15,8,8,8,8",hrows=3]
|===
5+^| Role: Query External Access (`query_external_access`)

.2+^h| Resources
4+^h| Privileges

^h| *Read*
^h| *Write*
^h| *Execute*
^h| *Manage*

^| Bucket [ * {vbar} _bucket-name_ ]: N1QL, curl
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/yes.png[]
^| image:introduction/no.png[]

^| UI
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]

^| Pools
^| image:introduction/yes.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
^| image:introduction/no.png[]
|===

== System Keyspaces (Tables)

In Couchbase Server 5.0, three new system keyspaces have been added:

* system:applicable_roles
* system:my_user_info
* system:user_info

Along with these three keyspaces, meta data related to roles and user access has been added as well.

This brings the total number of system keyspaces up to 12:

[cols="1,3"]
|===
| System Catalogs
a|
* xref:n1ql:n1ql-intro/sysinfo.adoc#querying-datastores[system:datastores]
* xref:n1ql:n1ql-intro/sysinfo.adoc#querying-namespaces[system:namespaces]
* xref:n1ql:n1ql-intro/sysinfo.adoc#querying-keyspaces[system:keyspaces]
* xref:n1ql:n1ql-intro/sysinfo.adoc#querying-dual[system:dual]

| Monitoring Catalogs
a|
* xref:n1ql:n1ql-intro/sysinfo.adoc#querying-indexes[system:indexes]
* <<topic_nvs_ghr_dz/sys-prepared,system:prepareds>>
* <<topic_nvs_ghr_dz/sys-completed-req,system:completed_requests>>
* <<topic_nvs_ghr_dz/sys-active-req,system:active_requests>>
* <<topic_nvs_ghr_dz/section_wwl_tsm_n1b,system:my_user_info>>

| Security Catalogs
a|
* <<topic_nvs_ghr_dz/system:user-info,system:user_info>>
* system:nodes
* <<topic_nvs_ghr_dz/system:applicable-roles,system:applicable_roles>>
|===

*SELECT Operations on System Keyspaces*

All of the system keyspaces support SELECT operations and are divided into the below security levels:

image::pict/concepts-rba-for-apps_table_SELECT.png[]
