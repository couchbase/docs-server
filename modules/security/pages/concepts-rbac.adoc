= RBAC for Administrators
:page-aliases: concepts-rbac,concepts-rba
:page-topic-type: concept

[abstract]
Role-Based Access Control (RBAC) for administrators is designed to manage administrative access to the Couchbase system and to achieve segregation of administrative duties.
With RBAC, each administrator can perform only a well-defined fixed set of operations based on the job description.

RBAC can be configured for internal or external users, and a userid can be mapped by the Full Administrator to one or more fixed administrative roles.
These roles contain a defined set of duties that can be performed in the system: users have no other administrative access except for the one defined in their role-assignment.

Full administrators in Couchbase can manage user roles using the Couchbase CLI tools (as described in xref:cli:cbcli/couchbase-cli-admin-role-manage.adoc[admin-role-manage]) or REST API (as described in xref:rest-api:rbac.adoc[Role Based Admin Access (RBAC)]).

== Fixed Administrative Roles in Couchbase

Fixed administrative roles in Couchbase Server are: Full, Cluster, Bucket, View, Replication, and FTS Administrator.

At a high-level, Couchbase has many resources:

* Cluster
* Server
* Bucket
* Index (GSI)
* Views (MapReduce and spatial)
* XDCR Cluster Reference
* XDCR Replication Stream

While Index and Views are tied to a bucket, XDCR exists at the cluster scope with setting up the cluster references, and at the bucket scope for replications.

The diagram below shows how these administrative roles correlate to each other.

image::pict/RBAC.png[]

Full Administrator:: The [.term]_Full Administrator_ role has permissions to read/write and manage all Couchbase resources, including the security settings such as adding a user to, or removing a user from a particular fixed role.

Read-only Administrator::
A [.term]_Read-Only Administrator_ has read-only access and cannot make any changes to the system.
This user has read-only access to cluster overview, design documents (without the ability to create or query views), bucket summaries (without the ability to create or view documents), XDCR cluster references, XDCR replications, and cluster settings.

Cluster Administrator:: The [.term]_Cluster Administrator_ role has permissions to read, write and manage all cluster-level settings except security settings of the cluster.

Bucket Administrator::
The [.term]_Bucket Administrator_ role has permissions to manage bucket settings.
This role can be assigned globally to all buckets (denoted by *), or to a particular bucket.
+
For XDCR operations, the Bucket Administrators can start/stop replication for the buckets they administer.
However, they cannot set up the XDCR cluster references.

View Administrator::
The [.term]_View Administrator_ role gives privileges to the user to define views and then run these views on data to ensure that views are defined properly.
This applies both to the map-reduce and spatial views.

Replication (XDCR) Administrator:: The [.term]_Replication Administrator_ role can configure XDCR topology, and manage replications for High Availability.

FTS Administrator:: The [.term]_FTS Administrator_ role allows Full Text Search features to be administered.

NOTE: Those with more than one administrator role will have all of the privileges of both (or all) roles granted.

.Role-Based Access Control (RBAC) for Administrators
[cols="2,1,1",hrows=2]
|===
.2+| Couchbase Resource and Administrative Roles 2+| Administrative Access: W(rite), R(ead), S(ecurity), none

h| Configuration
h| Statistics

3+^| *Full Administrator*

| Cluster
| W, R, S
| W, R, S

| ---XDCR RemoteCluster Reference
| W, R, S
| W, R, S

| ---Node
| W, R, S
| W, R, S

| ------Bucket [ * {vbar} [.var]`particular_bucket` ]
| W, R, S
| W, R, S

| ---------XDCR Replication Stream
| W, R, S
| W, R, S

| ---------Index (via REST API #8093)
| W, R, S
| W, R, S

| ---------Index (via UI #8091)
| W, R, S
| W, R, S

| ---------View (via REST API #8092)
| W, R, S
| W, R, S

| ---------View (via UI #8091)
| W, R, S
| W, R, S

3+^| *Read-only Administrator*

| Cluster
| R
| R

| ---XDCR RemoteCluster Reference
| R
| R

| ---Node
| R
| R

| ------Bucket [ * {vbar} [.var]`particular_bucket` ]
| R
| R

| ------XDCR Replication Stream
| R
| R

| ---------Index (via REST API #8093) ***
| R
| R

| ---------Index (via UI #8091)
| R
| R

| ---------View (via REST API #8092)
| R
| R

| ---------View (via UI #8091)
| R
| R

3+^| *Cluster Administrator*

| Cluster
| W, R
| W, R

| ---XDCR RemoteCluster Reference
| W, R
| W, R

| ---Node
| W, R
| W, R

| ------Bucket [ * {vbar} [.var]`particular_bucket` ]
| W, R
| W, R

| ---------XDCR Replication Stream
| W, R
| W, R

| ---------Index (via REST API #8093) (bucket users can access their buckets)**
| W, R
| W, R

| ---------Index (via UI #8091)
| W, R
| W, R

| ---------View (via REST API #8092)
| W, R
| W, R

| ---------View (via UI #8091)*
| W, R
| W, R

3+^| *Bucket Administrator*

| Cluster
| none
| none

| ---XDCR RemoteCluster Reference
| none
| none

| ---Node
| none
| none

| ------Bucket [ * {vbar} [.var]`particular_bucket` ]****
| W, R
| W, R

| ---------XDCR Replication Stream
| W, R
| W, R

| ---------Index (query) via REST API #8093 (bucket users can access their buckets ) **
| W, R
| W, R

| ---------Index (via UI #8091)
| none
| none

| ---------View (via REST API #8092)
| W, R
| W, R

| ---------View (via UI #8091) (for the buckets for which they are view administrators)*
| W, R
| W, R

3+^| *View Administrator*

| Cluster
| none
| none

| ---XDCR RemoteCluster Reference
| none
| none

| ---Node
| none
| none

| ------Bucket [ * {vbar} [.var]`particular_bucket` ]
| none
| none

| ---------XDCR Replication Stream
| none
| none

| ---------Index (query) via REST API #8093 ***
| none
| none

| ---------Index (query) via UI #8091
| none
| none

| ---------View via REST API #8092
| W, R
| W, R

| ---------View (via UI #8091) (for the buckets for which they are view administrators) *
| W, R
| W, R

3+^| *Replication (XDCR) Administrator*

| Cluster
| none
| none

| ---XDCR RemoteCluster Reference
| W, R
| W, R

| ---Node
| none
| none

| ------Bucket [ * {vbar} [.var]`particular_bucket` ]
| none
| none

| ---------XDCR Replication Stream
| W, R
| W, R

| ---------Index ***
| none
| none

| ---------View
| none
| none

3+^| *FTS Administrator*

| ------Bucket [ * {vbar} [.var]`particular_bucket` ]
| W, R
| W, R

| FTS
| W, R
| W, R

3+^| *Replication Target*

| ------Bucket [.var]`particular_bucket`
| W, R
| R

| Pools
| R
| none
|===

Explanations:

* W(rite), R(ead), S(ecurity), none (or no access).
* *: For views that are accessed through #8092, bucket credentials will be validated for the buckets that have the views.
* **: Multiple bucket passwords can be passed to authenticate to each password-protected bucket.
* ***: If a bucket is not protected with a password, a non-defined user role (none) can execute queries and read indexes.
* ****: The Bucket Administrator can perform all administrative actions that require read/write access to a specific bucket except for creating that bucket.

[#rbac-logging]
== RBAC Logging

Any authentication-failure will be logged in the log file for the resource on which access was attempted.
See xref:security-access-logs.adoc[Access Logs] for more information.
