= Eventing Role-Based Access Control (RBAC)
:description: pass:q[Full Administrators or users with proper _Role-Based Access Control_ (RBAC) roles can create and manage Eventing Functions.]

[abstract]
{description}

[#description]
== Description: What is RBAC

Couchbase provides _Role-Based Access Control_ (RBAC), in which access privileges are assigned to fixed roles; which are in turn assigned to users (each of which may be an administrator or an application) either _directly_; or _indirectly_, by means of _user-groups_.

Couchbase Server Enterprise Edition provides RBAC with multiple roles for finer access control.
Community Edition provides multiple users that can be assigned to limited set of roles.
There are three fixed roles in the community edition of Couchbase providing coarser access control: Bucket Full Access (`bucket_full_access[*]`), Admin (`admin`), and Read Only Admin (`ro_admin`).

A Couchbase-Server _role_ permits one or more _resources_ to be accessed according to defined _privileges_.
Roles can be assigned to individual users, and to groups, by means of either the UI or the REST API.

For a complete list of roles, see xref:learn:security/roles.adoc[Roles].
Note that most roles can be assigned only on the _Enterprise Edition_ of Couchbase Server: on the _Community Edition_ of Couchbase Server, only the `bucket_full_access`,
`admin`, and `ro_admin` roles can be assigned.

For more information, see xref:learn:security/authorization-overview.adoc[Authorization], and xref:manage:manage-security/manage-users-and-roles.adoc[Manage Users, Groups, and Roles].

== Function Scope

A bucket.scope combination used for identifying functions belonging to the same group.

Only the "Eventing Full Admin" role and also the "Full Admin" role can set the bucket.scope to  *+*+.+*+* all other Eventing non-privliged users need to define a *Function Scope* for their Evenitng functions that references an existing resource of bucket.scope.  This provides role based isolation of Eventing functoins between non-privliged users.

Typically you should set Function Scope to the bucket.scope that holds the collection that is the source of your mutations to your Eventing Function.  This best practice ensures that you do not inadvetantly cause an Eventing Function to undeply by removing a *Function Scope* pointing to a resource that is not required for the functon to run.

== Privileged Users

If a user role of either "Full Admin" or "Eventing Full Admin" it by default has all the nessesary access to every resource in a cluster required to run the Eventing Service and create and manage Eventing Functions.

When creating and Eventing Function either of these roles can set the *Function Scope* to *+*+.+*+* no other RBAC role is allowed to use this *Function Scope*.

NOTE: When upgrading to 7.1 all Eventing Functions are assumed to be running as a privileged user and have their *Function Scope* set to *+*+.+*+* to ensure continuity of your Eventing Functions.

=== Full Admin v. Eventing Full Admin

Prior to 7.0.0 Eventing always run as "Full Admin" this blocked some use cases and adoption as this role allowed creation of new users and the ability to escalate privilege sets. The  "Eventing Full Admin" role intoduced in 7.0 simply removes the capability of creating users and assigning/modifying RBAC credentials thus providing a bit more security.

For the Function Scope or RBAC grouping we will use the 'bulk.data' assuming you have the role of either "Full Admin" or "Eventing Full Admin". For standard or non-privileged users refer to Role-Based Access Control.

== Eventing and RBAC for Non-privileged Users

NOTE: If a user role of either "Full Admin" or "Eventing Full Admin" it by default has all the nessesary access to every resource in a cluster required to run the Eventing Service and create and manage Eventing Functions.

_In RBAC although you can assign rolls directly to a *USER* it is generally more flexible if you define a *GROUP* and assign that group or set of roles to a *USER*, this allows reusing a *GROUP* across multiple users._

== Minimal Eventing RBAC

The following minimal resources are required for a non-privliged user to access the Eventing Service and create and manage Eventing Functions.

* Data Reader
** Eventing Storage keyspace or Scratchpad
*Data Writer
** Eventing Storage keyspace or Scratchpad
* Data DCP reader
** Mutation Source
* Eventing / Manage Scope Function
** bucket.scope or bucket.*

Access the Couchbase Web Console > Security and Select "ADD GROUP".
+
image::rbac_min_groups.png[,%100]

You may consider adding

* Data Reader
** Mutation Source
* Data Writer
** Mutation Source
* Data Monitor
** Mutation Source
** Eventing Storage keyspace or Scratchpad

If you have any Bindings in your Eventing Function of type Bucket Alias you will need to have one or more additoinal settings if not already allowed.

* Data Reader
** Bucket Alias
* Data Writer
** Bucket Alias

If you plan to use N1QL consider adding at lease SELECT privlidges

* Query & Index / Query Select
** Mutation Source

