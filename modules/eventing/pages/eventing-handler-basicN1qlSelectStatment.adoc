= Function: basicN1qlSelectStatment
:page-edition: Enterprise Edition
:tabs:

*Goal*: Iterate through a basic N1QL select where Eventing interacts with the Data service via an inline N1QL statement.

* This function *basicN1qlSelectStatment* merely demonstrates how to perform a basic N1QL select.
* Requires that the "travel-sample" sample data loaded.
* Requires a metadata bucket, a source bucket of "travel-sample".
* Deploy the Function with a Feed Boundary "From now" (Warning, it will log 31,591 lines if you use "Everything")
* Then mutate any document in "travel-sample"
* For more detail refer to xref:eventing-language-constructs.adoc#added-lang-features[N1QL Statements]

[{tabs}] 
====
basicN1qlSelectStatment::
+
--
[source,javascript]
----
// Deploy from now then mutate a document in `travel-sample`
function OnUpdate(doc, meta) {
    var all_counts = {};  
    
    // Fetch our data and iterate across all the results
    // Note we don't look at the mutated document in this example
    var results =  
        SELECT COUNT(*) AS cnt, type from `travel-sample` GROUP BY type;
    for (var item of results) {   // Stream results using 'for' iterator.
        all_counts[item.type] = item.cnt;
    }
    results.close();              // End the query and free resources held
    
    // Just log it to the Application log
    log(all_counts);
}
----
--

Input Data/Mutation (via the following N1QL statement)::
+
--
[source,N1QL]
----
UPDATE `travel-sample` USE KEYS "airline_10" SET id = 10;
----
--

Output Data/Logged::
+ 
-- 
[source,json]
----
2020-08-25T13:13:41.513-07:00 [INFO] {"airline":187,"airport":1968,"hotel":917,"landmark":4495,"route":24024
----
--
====
