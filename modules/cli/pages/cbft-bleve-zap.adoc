= cbft-bleve for Zap Files
:page-topic-type: reference

[abstract]
The `cbft-bleve` tool supports commands that return information on _Zap_ files.

Each _Scorch_-index partition maintained by the _Search Service_ is represented by a _Zap_ file, which is located in the `store` sub-directory for the partition (see xref:cli:cbft-bleve.adoc#specifying-index-partitions[Specifying Index Partitions]).
Information can be retrieved from the Zap file, by means of the `zap` command.
The basic syntax is as follows:

----
cbft-bleve zap [command] [flags]
----

The possible values of `command` are listed in the sections below.
The value of `flags` can be `--help`, which prints help text to standard output.

== dict

The `dict` command prints the _term dictionary_ for a specified field of a specified index partition.
The syntax is as follows:

----
cbft-bleve zap dict [zap-file-path] [field] [flags]
----

The `field` argument is mandatory.

=== Example: Print the Term Dictionary

The following command prints the term dictionary for a specified index partition, and specifies the field `_id`:

----
/opt/couchbase/bin/cbft-bleve zap dict \
/Library/Application\ Support/Couchbase/var/lib/couchbase/\
data/@fts/demoIndex_1125629e41599ad8_92af29e5.pindex/store/\
000000000025.zap _id
----

If successful, the command returns output the initial lines of which are as follows:

----
2020/01/20 23:04:58 cbauth: key: fts/remoteClients registered for tls config updates
dictionary for field starts at 126674 (1eed2)
vellum length: 38115
raw vellum data:
 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 9c d6 00 10 9e e4 7b 05 b8 05 00 00 01 05 37 31 12 42 00 10 95 e3 16 10 94 00 10 a5 00 10 96 8d 0b 1f 04 00 00 01 1b 04 37 34 33 12 03 12
----

== docvalues

The `docvalues` command returns document values in order of field, and by number.
The syntax is as follows:

----
cbft-bleve zap docvalue [zap-file-path] [field] [docNum] [flags]
----

The `field` and `docNum` arguments are optional, and represent a field-name and a document-number, respectively.

=== Example: Return Document Values

The following example returns document values from a specific index partition, with the field-name `_id` specified:

----
/opt/couchbase/bin/cbft-bleve zap docvalue \
/vmhost_home/Library/Application\ Support/Couchbase/var/lib/couchbase/data/@fts/\
demoIndex_1125629e41599ad8_92af29e5.pindex/store/000000000025.zap _id
----

If successful, the command returns the following:

----
2020/01/20 23:31:36 cbauth: key: fts/remoteClients registered for tls config updates
Total Doc Values Size on Disk: 0.000000 MB
FieldID: 0 '_id' docvalue at 18446744073709551615 (ffffffffffffffff) numChunks 0  diskSize 0.000000 MB
Number of docvalue chunks: 0
----

== stored

The `stored` command prints the raw stored data bytes for a specified document number.
The syntax is as follows:

----
cbft-bleve zap stored [zap-file-path] [docNum] [flags]
----

The required `docNum` argument is the number of a document.

=== Example: Return Data Bytes for a Document

The following command returns the data bytes for document 2000, as listed in a specified Zap file.

----
/opt/couchbase/bin/cbft-bleve zap stored \
/vmhost_home/Library/Application\ Support/Couchbase/var/lib/couchbase/data/@fts/\
demoIndex_1125629e41599ad8_92af29e5.pindex/store/000000000025.zap 2000
----

If successful, the command returns the following:

----
2020/01/20 23:46:51 cbauth: key: fts/remoteClients registered for tls config updates
Stored field starts at 30827 (0x786b)
Meta Len: 1
Data Len: 15
Raw meta: 0e
Raw data (len 15): 6c 61 6e 64 6d 61 72 6b 5f 32 35 33 31 39 00
Raw _id (len 14): 6c 61 6e 64 6d 61 72 6b 5f 32 35 33 31 39
Raw fields (len 1): 00
Uncompressed fields (len 0):
----

== explore

The `explore` command explores the index by _field_, _term_, or _document number_.
The syntax is as follows:

----
bleve zap explore [path] [field] [term] [docNum] [flags]
----

One `field`, one `term`, or one `docNum` should be specified.

=== Example: Explore by Field

The following command explores the specified index partition by the `_id` field:

----
opt/couchbase/bin/cbft-bleve zap explore \
/vmhost_home/Library/Application\ Support/Couchbase/var/lib/couchbase/data/@fts/\
demoIndex_1125629e41599ad8_92af29e5.pindex/store/000000000025.zap _id
----

If successful, the command returns output the initial lines of which are as follows:

----
2020/01/21 00:08:16 cbauth: key: fts/remoteClients registered for tls config updates
dictionary for field starts at 126674 (1eed2)
vellum length: 38115
raw vellum data:
 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 9c d6 00 10 9e e4 7b 05 b8 05 00 00 01 05 37 31 12 42 00 10 95 e3 16 10 94 00 10 a5 00 10 96 8d 0b 1f 04 00 00 01 1b 04 37 34 33 12 03 12 10 a6 e6 1d 10 a4 00 10 a4
----

== fields

The `fields` command prints the fields in a specified Zap file.
The syntax is as follows:

----
cbft-bleve zap fields [zap-file-path] [flags]
----

=== Example: Print the Fields in a File

The following example prints the fields in the specified Zap file:

----
/opt/couchbase/bin/cbft-bleve zap fields \
/vmhost_home/Library/Application\ Support/Couchbase/var/lib/couchbase/data/@fts/\
demoIndex_1125629e41599ad8_1c9ffdcc.pindex/store/000000000026.zap
----
If successful, the command prints out the following:

----
2020/01/21 00:23:42 cbauth: key: fts/remoteClients registered for tls config updates
field 0 '_id' starts at 126819 (1ef63)
----

== footer

The `footer` command prints out the footer for the specified Zap file.
The syntax is as follows:

----
cbft-bleve zap footer [zap-file-path] [flags]
----

=== Example: Print out Footer of Zap File

The following example prints out the footer of the specified Zap file:

----
sudo /opt/couchbase/bin/cbft-bleve zap footer \
/vmhost_home/Library/Application\ Support/Couchbase/var/lib/couchbase/data/@fts/\demoIndex_1125629e41599ad8_1c9ffdcc.pindex/store/000000000026.zap
----

If successful, the command prints out the following:

----
2020/01/21 00:25:24 cbauth: key: fts/remoteClients registered for tls config updates
Length: 164944
CRC: 0xcf1c9806
Version: 11
Chunk Factor: 1024
Fields Idx: 164892 (0x2841c)
Stored Idx: 83323 (0x1457b)
DocValue Idx: 164865 (0x28401)
Num Docs: 5437
----
