[#cbstats-vbucket]
= [.cmd]`vbucket`

[abstract]
Provides information about the type of all buckets, or whether they are active or replica.

== Syntax

Request syntax for vBucket:

----
cbstats [host]:11210 vbucket
        cbstats [host]:11210 vbucket-details [vbid]
        cbstats [host]:11210 vbucket-seqno [vbid]
----

These requests are used as follows:

* [.cmd]`vbucket`: Lists all available vBuckets and provides information about their type: active or replica.
* [.cmd]`vbucket-details`: Uses the option VBID or vBucket ID to provide details about a specific vBucket.
* [.cmd]`vbucket-seqno`: Uses the option VBID or vBucket ID to provide details connected to the vBucket's sequence number.
// This has to be
//             verified, it's just my guess.

== Description

The [.cmd]`vbucket` command shows whether a vBucket is an active or a replica vBucket.

.vBucket stats
[cols="100,217"]
|===
| Stat | Description

| `ep_vb_total`
| Total vBuckets (count).

| `curr_items_tot`
| Total number of items.

| `curr_items`
| Number of active items in memory.

| `curr_temp_items`
| Number of temporary items in memory.

| `vb_dead_num`
| Number of dead vBuckets.

| `ep_diskqueue_items`
| Total items in disk queue.

| `ep_diskqueue_memory`
| Total memory used in disk queue.

| `ep_diskqueue_fill`
| Total enqueued items on disk queue.

| `ep_diskqueue_drain`
| Total drained items on disk queue.

| `ep_diskqueue_pending`
| Total bytes of pending writes.

| `ep_vb_snapshot_total`
| Total VB state snapshots persisted in disk.

| `ep_meta_data_memory`
| Total memory used by meta data.
|===

Description of replica vBucket satistics.

.Active vBucket stats
[cols="100,217"]
|===
| Stat | Description

| vb_active_num
| Number of active vBuckets

| vb_active_curr_items
| Number of in memory items

| vb_active_num_non_resident
| Number of non-resident items

| vb_active_perc_mem_resident
| % memory resident

| vb_active_eject
| Number of times item values got ejected

| vb_active_expired
| Number of times an item was expired

| vb_active_ht_memory
| Memory overhead of the hashtable

| vb_active_itm_memory
| Total item memory

| vb_active_meta_data_memory
| Total metadata memory

| vb_active_ops_create
| Number of create operations

| vb_active_ops_update
| Number of update operations

| vb_active_ops_delete
| Number of delete operations

| vb_active_ops_reject
| Number of rejected operations

| vb_active_queue_size
| Active items in disk queue

| vb_active_queue_memory
| Memory used for disk queue

| vb_active_queue_age
| Sum of disk queue item age in milliseconds

| vb_active_queue_pending
| Total bytes of pending writes

| vb_active_queue_fill
| Total enqueued items

| vb_active_queue_drain
| Total drained items
|===

Description of replica vBucket satistics.

.Replica vBucket stats
[cols="100,217"]
|===
| Stat | Description

| vb_replica_num
| Number of replica vBuckets

| vb_replica_curr_items
| Number of in memory items

| vb_replica_num_non_resident
| Number of non-resident items

| vb_replica_perc_mem_resident
| % memory resident

| vb_replica_eject
| Number of times item values got ejected

| vb_replica_expired
| Number of times an item was expired

| vb_replica_ht_memory
| Memory overhead of the hashtable

| vb_replica_itm_memory
| Total item memory

| vb_replica_meta_data_memory
| Total metadata memory

| vb_replica_ops_create
| Number of create operations

| vb_replica_ops_update
| Number of update operations

| vb_replica_ops_delete
| Number of delete operations

| vb_replica_ops_reject
| Number of rejected operations

| vb_replica_queue_size
| Replica items in disk queue

| vb_replica_queue_memory
| Memory used for disk queue

| vb_replica_queue_age
| Sum of disk queue item age in milliseconds

| vb_replica_queue_pending
| Total bytes of pending writes

| vb_replica_queue_fill
| Total enqueued items

| vb_replica_queue_drain
| Total drained items
|===

== Options

.vbucket options
[cols="1,2"]
|===
| Option | Description

| VBID
| vBucket ID.
|===

== Examples

Example requests:

----
cbstats 10.5.2.54:11210 vbucket
----

----
cbstats 10.5.2.54:11210 vbucket-details 115
----

----
cbstats 10.5.2.54:11210 vbucket-seqno 115
----

*Responses*

Example response for `vbucket`:

----
 vb_0:    replica
 vb_1:    replica
 vb_10:   replica
 vb_100:  active
 vb_1000: replica
 vb_1001: replica
 vb_1002: replica
 vb_1003: replica
 vb_1004: replica
 vb_1005: replica
 ...
----

Example response for `vbucket-details`:

----
 vb_115:                  active
 vb_115:db_data_size:     174
 vb_115:db_file_size:     24622
 vb_115:high_seqno:       0
 vb_115:ht_cache_size:    0
 vb_115:ht_item_memory:   0
 vb_115:ht_memory:        25096
 vb_115:num_ejects:       0
 vb_115:num_items:        0
 vb_115:num_non_resident: 0
 vb_115:num_temp_items:   0
 vb_115:ops_create:       0
 vb_115:ops_delete:       0
 vb_115:ops_reject:       0
 vb_115:ops_update:       0
 vb_115:pending_writes:   0
 vb_115:purge_seqno:      0
 vb_115:queue_age:        0
 vb_115:queue_drain:      0
 vb_115:queue_fill:       0
 vb_115:queue_memory:     0
 vb_115:queue_size:       0
 vb_115:uuid:             219212055839841
----

Example response for `vbucket-seqno`:

----
 vb_115:abs_high_seqno: 0
 vb_115:high_seqno:     0
 vb_115:purge_seqno:    0
 vb_115:uuid:           219212055839841
----
