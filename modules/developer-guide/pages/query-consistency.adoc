[#concept_vkw_fxf_4t]
= Reading your writes

[abstract]
In order to make query execution as quick as possible, queries are executed against an index.
When documents are created, removed, or otherwise modified, the index is updated asynchronously.

Because indexes are updated asynchronously, a query that is issued immediately after a document mutation may not relfect the recently-executed mutation.

----
cb.upsert('user:12345', {
    'names': ['Brass', 'Doorknob'],
    'emails': ['brass.doorknob@juno.com']
})

query = N1QLQuery(
    'SELECT names, emails FROM users WHERE $1 IN names', 'Brass')
for row in cb.n1ql_query(query):
    print row
----

In the above example, the `user:12345` may not be reflected in the query results if the asynchronous index update took place after the query was executed.

== Forcing query to wait until the index has been updated

----
from couchbase.n1ql import CONSISTENCY_REQUEST
query = N1QLQuery(
    'SELECT names, emails FROM default WHERE $1 IN names', 'Brass')
query.consistency = CONSISTENCY_REQUEST
----

https://github.com/couchbaselabs/devguide-examples/blob/master/c/query-consistency.cc[C] | https://github.com/couchbaselabs/devguide-examples/blob/master/python/query-consistency.py[Python] | Java | .NET | node.js
