

[#release-726]
== Release 7.2.6 (June 2024)

Couchbase Server 7.2.6 was released in June 2024.
This maintenance release contains new features and fixes.

[#new-features-726]
=== New Features and Enhancements

==== Cluster Manager

[#table-new-features-726-cluster-manager, cols="10,40"]
|===
|Feature | Description

| https://issues.couchbase.com/browse/MB-61816[MB-61816]
| The `cm_rebalance_total`, `cm_failover_total`, and `cm_graceful_failover_total` stats have been added.

Each stat contains a label named event
 (`initiated`, `completed`,`failed`, and `stopped`) and the number of occurrences for the labeled event.

| https://issues.couchbase.com/browse/MB-62036[MB-62036]
a| The following stats have been added:
[horizontal]
  cm_auto_failover_count:: The number of auto-failovers that have occurred.
  cm_auto_failover_enabled:: Indicates if auto-failover is enabled (1 = true, 0 = false)
  cm_auto_failover_max_count:: The maximum number of auto-failovers before being disabled

|===

==== Tools

[#table-new-features-726-tools, cols="10,40"]
|===
|Feature | Description

|https://issues.couchbase.com/browse/MB-61482[MB-61482]
| The documentation references code examples built with the `cbq` command line tool. +
Since the examples are also used by Capella users, the `cbq` tool is now part of the tools package.

|===



=== Fixed Issues

==== XDCR

[#table-new-features-726-xdcr, cols="10,40,40"]
|===
|Issue | Description | Resolution

| https://issues.couchbase.com/browse/MB-62005[MB-62005]
| When none of the nodes in the remote reference DNS SRV entry is reachable, XDCR could be stuck working off of a stale list of nodes.
| Now, XDCR will be able to re-bootstrap from the top DNS SRV entry

| https://issues.couchbase.com/browse/MB-62006[MB-62006]
| Stale connectivity errors were not cleared.
| Stale connectivity errors are now cleared correctly.

| https://issues.couchbase.com/browse/MB-62097[MB-62097]
| When the pipeline is unable to start, Prometheus metrics did not capture the errors and the error state.
| The Prometheus stats will now correctly indicate the error situation as in error, as  well as the number of errors.

| https://issues.couchbase.com/browse/MB-62104[MB-62104]
| Connectivity node status map might not be synced with `cachedRefNodesList` after refresh
| When there is a rebalance (topology change) on the target cluster, XDCR will have an updated node list to keep track of the connectivity statuses of the target cluster nodes.

| https://issues.couchbase.com/browse/MB-62150[MB-62150]
| Deadlock caused by `routingUpdater` when the pipeline is stopping
| The fix addresses the edge case whereby the `routingUpdater` raises a backfill-related event that gets stuck because of a race condition with closing the replication pipeline.

| https://issues.couchbase.com/browse/MB-62384[MB-62384]
| There are situations where CAS values for documents are set incorrectly (i.e., way in the future).  +
When XDCR replications are set up, these source documents are then replicated to targets.
| When a document is considered CAS poisoned, it will be filtered out and will not be replicated. XDCR will consider the document “CAS_poisoned” and will account for it in a counter stat. +
XDCR will move on and continue to replicate other documents that are tagged with later sequence numbers to keep the pipeline moving. XDCR will not retain the document keys of the offending documents. +
A UI error/message will be shown on the console and the
Prometheus counter stat will have a “CAS_poisoned” counter that shows a value greater than zero. This counter value is also recorded in the XDCR logs.



|===


==== Query Service

[#table-fixed-issues-726-query-service, cols="10,40,40"]
|===
|Issue | Description | Resolution


| https://issues.couchbase.com/browse/MB-61564[MB-61564]
| Incorrect return code when attempting to create an index that already exists.
The system returns the error: `200: index already exists`.
| The system will now return: `409: index already exists`.

| https://issues.couchbase.com/browse/MB-62042[MB-62042]
| When the input to `STR_TO_TZ` has `'Z'` as the time zone, the output uses an hour-only format.
  (e.g., `STR_TO_TZ("2024-01-01T00:00:00Z", "America/Los_Angeles") -> "2023-12-31T16:00:00-08"`) +
  In version 6 and version 7.6+ the output is `"2023-12-31T16:00:00-08:00"`.
  This affects comparisons as the strings differ.
| The `STR_TO_TZ` function will return the output in the correct format: (e.g., `2023-12-31T16:00:00-08:00`)

|===


==== Eventing Service

[#table-fixed-issues-726-eventing-service, cols="10,40,40"]
|===
|Issue | Description | Resolution

| https://issues.couchbase.com/browse/MB-61877[MB-61877]
| Incorrect CRC-64 encoded value for string argument
| Fixed encoding when input string contains a null terminator.

|===










