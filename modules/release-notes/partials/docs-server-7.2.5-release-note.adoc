
:erlang-7-2-4-note: The Erlang upgrade requires that users have installed Couchbase Server{nbsp}7.1.0 or later, before upgrading to 7.2.4.

[#release-725]
== Release 7.2.5 (April 2024)

Couchbase Server 7.2.5 was released in April 2024. 
This maintenance release contains new features and fixes.

[#new-features-725]
=== New Features and Enhancements

==== XDCR

[#table-new-features-725-xdcr, cols="10,40"]
|===
|Feature | Description


| https://issues.couchbase.com/browse/MB-60892[MB-60892]
| `XDCR` will no longer roll back to 0 due to purge sequence number moving ahead of a replication's checkpoint.



| https://issues.couchbase.com/browse/MB-61303[MB-61303]
| Once faulty remote cluster credentials are fixed, XDCR will now be able to  restart replications that depend on the repaired references more quickly.

|===

==== Analytics

[#table-new-features-725-analytics, cols="10,40"]
|===
|Feature | Description

| https://issues.couchbase.com/browse/MB-60813[MB-60813]
| This release adds the `median` function to the builtin analytics functions. 
See xref:server:analytics:8_builtin.adoc[].

|===


==== Index Manager

[#table-new-features-725-cluster-manager, cols="10,40"]
|===
|Feature | Description

| https://issues.couchbase.com/browse/MB-61310[MB-61310]
a| During rebalance, Couchbase Server tracks its progress in moving active index partitions by comparing the sequence number of partitions it has moved to the sequence numbers in a view on the original node.
It did not use this technique to track the progress of copying replica partitions.

This change adds an argument to the `api/managerOptions` REST API call named `enableReplicaCatchupOnRebalance`. 
If you set this argument to `true`, Couchbase Server tracks the progress of copying replica partitions the same way it tracks active partitions.

NOTE: Enabling this option adds some overhead to the rebalance process.

|===

[#fixed-issues-725]
=== Fixed Issues

==== Cluster Manager

[#table-fixed-issues-725-cluster-manager, cols="10,40,40"]
|===
|Issue | Description | Resolution

| https://issues.couchbase.com/browse/MB-43772[MB-43772]
| The response returned by the `/metrics` endpoint would fail validation via `promtool` check due to duplicate entries.
| Issue resolved.

| https://issues.couchbase.com/browse/MB-60568[MB-60568]
| When running a VM on a XEN hypervisor, metrics were computed using the number of processors configured for the entire system.
a| The calculation now uses the number of logical processors online on the system. This correction affects the following metrics:

* sys_cpu_host_cores_available

* sys_cpu_utilization_rate

* sys_cpu_host_utilization_rate


| https://issues.couchbase.com/browse/MB-61419[MB-61419]
| Blocked port prevents node addition to cluster.
| Added timeout on port request to prevent the addition from being blocked.

|===

==== Views
[#table-fixed-issues-725-views, cols="10,40,40"]
|===
|Issue | Description | Resolution

| https://issues.couchbase.com/browse/MB-60744[MB-60744]
| Unauthorized user event is not logged in the audit log
| Issue resolved.

|===

==== XDCR
[#table-fixed-issues-725-xdcr, cols="10,40,40"]
|===
|Issue | Description | Resolution

| https://issues.couchbase.com/browse/MB-60326[MB-60326]
| XDCR pipeline shutdown is stuck, causing a resource leak.
| Issue resolved.

| https://issues.couchbase.com/browse/MB-61208[MB-61208]
| The developer injection code is getting triggered because the value from the settings map is nil, and as a result, the integer value returned is -1. This is typecast to `uint32` resulting in the incorrect value
| Issue resolved.

| https://issues.couchbase.com/browse/MB-60616[MB-60616]
| When `goxdcr` process is killed in a paused replication state, `changes_left` had a negative value.
| Issue resolved.

| https://issues.couchbase.com/browse/MB-60859[MB-60859]
| During target cluster rebalance, XDCR will error out with invalid packets because of VBucket movements.
| Issue resolved. VBucket movements will no longer cause packet errors.

| https://issues.couchbase.com/browse/MB-60930[MB-60930]
| `MergeNewTasks` of backfillSpec can append a null task in the task list
| XDCR backfill pipeline will not contain null tasks, avoiding unnecessary trigger of backfill pipeline.

| https://issues.couchbase.com/browse/MB-61295[MB-61295]
| When the target memcached responds with non-temporary error status codes (e.g., `EINVAL`), the replication gets stuck at this point, and is not flagged in the UI.
| XDCR will now notify users of non-temporary errors and their occurrence counts under the appropriate replication UI element.

| https://issues.couchbase.com/browse/MB-61414[MB-61414]
| JSON documents are considered invalid when there are whitespace characters at the end of the document during filtering.
| JSON documents with terminating whitespaces are now processed correctly and can be replicated with advanced filtering.

|===

==== Query Service
[#table-fixed-issues-725-query-service, cols="10,40,40"]
|===
|Issue | Description | Resolution

| https://issues.couchbase.com/browse/MB-60294[MB-60294]
| `COUNT(*)` on `system:indexes` can return incorrect results
| Issue resolved.

|===

==== Index Service

[#table-fixed-issues-725-index-service, cols="10,40,40"]
|===
|Issue | Description | Resolution

| https://issues.couchbase.com/browse/MB-60972[MB-60972]
| Previously, an index scan would continue reading data until it had returned at least one row of data,
even if it had been canceled or had timed out.
These continued reads resulted in wasted CPU resources and potentially blocking other scans from starting.

| Couchbase Server now stops an index scan from reading data after it has timed out or a client cancels it even if it has not produced a row of data.

| https://issues.couchbase.com/browse/MB-61043[MB-61043]
| A rebalance followed by a failover could result in partitions not being evenly distributed across all nodes by a later rebalance.
| The rebalance process now detects the partition skew and fixes it.

| https://issues.couchbase.com/browse/MB-61435[MB-61435]
| An optimization that skips key-value lookups in some cases when inserting new keys could be incorrectly enabled for all indexes in buckets containing empty indexes.
This issue could result in duplicate rows being added to indexes.
| The optimization is no longer incorrectly applied to indexes, and duplicate rows are no longer added to indexes.

|===


=== Known Issues

==== Query Service

[#table-known-issues-725-query-service, cols="1,2,2"]
|===
|Issue | Description | Workaround

include::partial$docs-server-7.2.4-release-note.adoc[tag="MB-61564"]

|===
