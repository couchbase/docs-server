= BEGIN TRANSACTION
:page-topic-type: concept
:page-status: Couchbase Server 7.0
:imagesdir: ../../assets/images

// Cross-references
:insert: xref:n1ql:n1ql-language-reference/insert.adoc
:upsert: xref:n1ql:n1ql-language-reference/upsert.adoc
:delete: xref:n1ql:n1ql-language-reference/delete.adoc
:update: xref:n1ql:n1ql-language-reference/update.adoc
:merge: xref:n1ql:n1ql-language-reference/merge.adoc
:select: xref:n1ql:n1ql-language-reference/selectintro.adoc
:execfunction: xref:n1ql:n1ql-language-reference/execfunction.adoc
:prepare: xref:n1ql:n1ql-language-reference/prepare.adoc
:execute: xref:n1ql:n1ql-language-reference/execute.adoc
:transactions: xref:learn:data/transactions.adoc
:tximplicit: xref:settings:query-settings.adoc#tximplicit

// Related links
:begin-transaction: xref:n1ql-language-reference/begin-transaction.adoc
:set-transaction: xref:n1ql-language-reference/set-transaction.adoc
:savepoint: xref:n1ql-language-reference/savepoint.adoc
:commit-transaction: xref:n1ql-language-reference/commit-transaction.adoc
:rollback-transaction: xref:n1ql-language-reference/rollback-transaction.adoc

[abstract]
The `BEGIN TRANSACTION` statement enables you to begin a transaction.

== Purpose

The `BEGIN TRANSACTION` statement enables you to begin a sequence of statements as an ACID transaction.
Refer to {transactions}[Transactions] for further information.

* Only DML statements are permitted within the transaction: {insert}[INSERT], {upsert}[UPSERT], {delete}[DELETE], {update}[UPDATE], {merge}[MERGE], {select}[SELECT], {execfunction}[EXECUTE FUNCTION], {prepare}[PREPARE], or {execute}[EXECUTE].

* The `EXECUTE FUNCTION` statement is only permitted in a transaction if the user-defined function does not contain any subqueries other than `SELECT` subqueries.

* The `PREPARE` and `EXECUTE` statements are only permitted in a transaction for the permitted statements listed above.

NOTE: You can also specify a single DML statement as an ACID transaction by setting the {tximplicit}[tximplicit] query parameter.

== Syntax

[subs="normal"]
----
begin-transaction ::= ( BEGIN | START ) ( WORK | TRAN | TRANSACTION ) [ ISOLATION LEVEL READ COMMITTED ]
----

image::n1ql-language-reference/begin-transaction.png["( 'BEGIN' | 'START' ) ( 'WORK' | 'TRAN' | 'TRANSACTION' ) ( 'ISOLATION' 'LEVEL' 'READ' 'COMMITTED' )?"]

The `BEGIN` and `START` keywords are synonyms.
The statement must begin with one of these keywords.

The `WORK`, `TRAN`, and `TRANSACTION` keywords are synonyms.
The statement must contain one of these keywords.

=== Transaction Settings

Currently, the only available transaction setting is "isolation level read committed".
This setting is enabled by default.
The `ISOLATION LEVEL READ COMMITTED` keywords are therefore optional and may be omitted.

== Return Value

The statement returns an object containing the following property.

txid::
The transaction ID.
You must supply this transaction ID with any subsequent statements that form part of the same transaction.

== Examples

.Begin a transaction
====
.CURL request
[source,console]
----
$ curl http://localhost:8093/query/service \
-u Administrator:password \
-H 'Content-Type: application/json' \
-d '{
  "statement": "START TRANSACTION",
  "pretty": true,
  "txtimeout": "2m", // <.>
  "scan_consistency": "request_plus", // <.>
  "durability_level": "majority" // <.>
}'
----

<.> The transaction timeout.
<.> The transaction scan consistency.
No scan consistency is set for individual statements within the transaction; they inherit from the transaction scan consistency.
<.> Durability level of all the mutations within the transaction.

.Result
[source,json]
----
[
    {
        "txid": "d81d9b4a-b758-4f98-b007-87ba262d3a51" // <.>
    }
]
----
<.> The transaction ID.
You must use this ID to add further statements to the transaction.
====

.A statement participating within the transaction
====
.CURL request
[source,console]
----
$ curl http://localhost:8093/query/service \
-u Administrator:password \
-H 'Content-Type: application/json' \
-d '{
  "statement": "SELECT ...",
  "pretty": true,
  "txid": "d81d9b4a-b758-4f98-b007-87ba262d3a51" // <.>
}'
----

<.> The transaction ID generated when the transaction began.
====

== Related Links

* To specify transaction settings, refer to {set-transaction}[SET TRANSACTION].
* To set a savepoint, refer to {savepoint}[SAVEPOINT].
* To rollback a transaction, refer to {rollback-transaction}[ROLLBACK TRANSACTION].
* To commit a transaction, refer to {commit-transaction}[COMMIT TRANSACTION].