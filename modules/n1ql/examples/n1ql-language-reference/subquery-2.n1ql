SELECT t1.country, array_agg(t1.city), sum(t1.city_cnt) as apnum
FROM (SELECT city, city_cnt, array_agg(airportname) as apnames, country
      FROM airport GROUP BY city, country
      LETTING city_cnt = count(city)) AS t1
WHERE t1.city_cnt > 5
GROUP BY t1.country;