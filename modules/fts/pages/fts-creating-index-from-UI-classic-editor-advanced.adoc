= Classic Editor

[abstract]
A classic editor is an advanced tool where users can directly configure the index mapping. 

This section introduces index creations via a step by step walk through using the classic editor.  The reader should be already familiar with the basic concepts of full-text search 

= Creating an Advanced Index

This section describes creating and Index on a bucket's non-default scope/collection on just one field.  

To create an advanced Search index on the bucket: travel-sample, scope: inventory, collection: landmark, and field: content, through the Classic Editor:

* Access the *Couchbase Web Console* > *Search* page.
+
image::fts-search-page.png[,,align=left]

* Click the *Add Index* link in the upper right.
+
image::fts-add-initial.png[,600,align=left]

*To define any index on which Full Text Search a unique name for the index in the *Index Name* field, on the upper-left. Note that only alphanumeric characters, hyphens, and underscores are allowed for index names and the first character of the name must be alphabetic. 
+
Enter *landmark-content-index* as the name of the Search index you are creating in the *Index Name* text-box.
+
image::fts-index-name-nondefault.png[,450,align=left]

* Select the bucket *travel-sample* from the *Bucket* pull-down menu.
+
Use the pull-down menu provided for the Bucket field, on the upper-right, and select a bucket that you are allowed to access to via the cluster's RBAC settings.
+
image::fts-index-name-and-bucket-nondefault.png[,450,align=left]

* Select the checkbox *[X] Use non-default scope/collections* 
+
This allows your index to stream mutations from one or more non-default collections under the selected bucket and scope.
+
image::fts-select-nondefault-scope-collections.png[,450,align=left]

* Use the newly visible pull-down menu provided for the *Scope* field, under the *[X] Use non-default scope/collections* checkbox, and select a bucket that you are allowed to access to via the cluster's RBAC settings.
+
For this example select *inventory* which has multiple collections under it. 
+ 
image::fts-select-scope-nondefault.png[,450,align=left]

* Under *Type Mapings*, unselect the checkbox *[ ]  default | dynamic* - this will get rid of the warning in the prior step.
+
This is required as this type mapping is only valid for the <bucket>._default._default which is typically used to upgrade a 6.X server form a bucket into a collections paradigm.
+
image::fts-uncheck-default-mapping.png[,450,align=left]

* Click on the button *+ Add Type Mapping*

** A new section with a *Collection* pull-down, *Analyzer* pull-down and a *[ ] only index specified fields* checkbox will appear.
+
image::fts-index-menu1-nondefault-empty.png[,600,align=left]

** Select *landmark* from the *Collection* pull-down, note the pull down will change to a text field prefilled with *inventory.landmark*

** Check the *[X] only index specified fields* checkbox.
+ 
image::fts-index-menu1-nondefault-filled.png[,600,align=left]

** Click on the blue *ok* at the right of the section to save this mapping.

** Hover over your newly created/saved row 

** Click on the blue *+* button the right side of the row.
+ 
image::fts-index-menu1-nondefault-hover.png[,600,align=left]

** A context menu of "insert child mapping" (for sub-objects) and "insert child field" (for properties) will appear.
+
image::fts-index-menu2-nondefault-select.png[,600,align=left]

** Select *insert child field*

** another row menu will appear with the following controls: "field", "type", "text", "searchable as", "analyzer" "inherit", "index", "store", "include in _all field", "include term vectors", and "docvalues".
+
image::fts-index-menu2-nondefault-empty.png[,600,align=left]

** Set the text box *field* to *content*, this will also update "searchable as" to *content*.

** Check *[X]* all the boxes "store", "include in _all field", "include term vectors", and "docvalues"

** Click on the blue *ok* at the right of the section to save this sub-form.
+ 
image::fts-index-menu2-nondefault-filled.png[,600,align=left]

* Save your index, left-click on the *Create Index* button near the bottom of the screen.
+
This is all you need to specify in order to create a more advanced index for test and development. No further configuration is required.
+
image::fts-index-create-button.png[,450,align=left]

* If you subsequently Edit your Index it should look like the following:
+
image::fts-edit-index-nondefault.png[,600,align=left]

NOTE: This index is an example of a potentially optimal index for use in a production environments since it creates only on index on a needed field as such it will be more performant that the first example.

== Test the Advanced Index with a simple query

In the *Couchbase Web Console* > *Search* page.

* Click on the index you just created (named "landmark-content-index") to expand the Index's controls.

* In the text area of the search box enter *+view +food +beach* this will search on all three keywords

* Click on the blue *Search* button. You will get documents from only collection landmark and due to the options you selected you will see highlighted words in your results.
+
image::fts-index-nondefault-search.png[,,align=left]

* Verify you have some results
+
image::fts-index-nondefault-search-results.png[,,align=left]

= Full Text Search Screen / Other

Once you hit the  *Create Index* button you will return to the *Couchbase Web Console* > *Search* page (note, if you tested any index just access the *Couchbase Web Console* > *Search* page again).

At this point, you are returned to the Full Text Search screen. 

A new row now appears for the index you have just created. When left-clicked on, the row opens or expands as follows:

image::fts-new-index-progress.png[,,align=left]

== Index Build Progress

Once the new index has been built, it supports Full Text Searches performed by all available means: the Console UI, the Couchbase REST API, and the Couchbase SDK.

=== Statistic: docs processed

The percentage figure appears under the indexing progress column and represents the number of documents present in the index.  

* On an initial build this may take a while to process all the documents.  

* A mutation to an existing document will not increment this count (unless new items are added).

=== Statistic: indexing progress

The percentage figure appears under the indexing progress column and is incremented in correspondence with the build-progress of the index. When 100% is reached, the index build is complete. 

* However, search queries will be allowed as soon as the index is created, meaning partial results can be expected until the index build is complete.  

* If later mutations com in the percentage may actually jump around as batches of documents are processed.

* If one or more of the nodes in the cluster running data service goes down and/or are failed over, indexing progress may show a value > 100%.  

[#using-the-show-index-definition]
== Show Index Definition JSON

This expandable section shows the JSON document that describes the current index configuration, as created by means of the user interface.  

A checkbox *[ ]  Show curl command to modify this index definition" wrap the definition with a command line cURL syntax.  

You can copy either variant (the cURL mode) and the definitions can be used via the Search REST API or any Couchbase SDK.

image::fts-show-index-definition.png[,,align=left]

[#using-the-index-definition-preview]
== Using the Index Definition Preview

The _Index Definition Preview_ appears to the right-hand side of the *Add Index* (or an *Edit Index*) screen.

Following index-definition, the upper portion may appear as follows:

[#fts_index_definition_preview]
image::fts-index-definition-preview.png[,,align=left]

This preview (like the *Show Index Definition JSON* from the main Search page) consists of the JSON document that describes the current index configuration, as created by means of the user interface.
By left-clicking on the [.ui]*copy to clipboard* tab, the definition can be saved.   

These definitions can be used via the Search REST API or any Couchbase SDK.

= Other Advanced Index Options

The *Creating a Basic Index* provides a simple introduction to using Search, however it is not optimized nor does it expose many useful features that the Search service supports.  This example only runs on the _default scope/collection and should be considered a legacy mode.

The *Creating an Advanced Index* (this example) starts to introduce advanced feature for optimizing and using a Search index. This example does not cover adding multiple collections under a scope, adding multiple field or fields from sub-objects. 

The complete range of available options for creating  Search indexes for any production environment is covered here: xref:fts-creating-indexes.adoc[Creating Indexes].

