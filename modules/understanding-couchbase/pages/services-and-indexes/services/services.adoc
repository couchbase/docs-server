[#services]
= Services

[abstract]
Couchbase _Services_ support access to and maintenance of data.

== Services

Couchbase Server provides the following services:

{blank}

* *Data*: Supports the storing, setting, and retrieving of data-items, specified by key.
+
{blank}

* *Query*: Parses queries specified in the _N1QL_ query-language, executes the queries, and returns results.
The Query Service interacts with both the Data and Index services.
+
{blank}

* *Index*: Creates indexes, for use by the Query and Analytics services.
+
{blank}

* *Search*: Create indexes specially purposed for _Full Text Search_.
This supports language-aware searching; allowing users to search for, say, the word `beauties`, and additionally obtain results for `beauty` and `beautiful`.
+
{blank}

* *Analytics*: Supports join, set, aggregation, and grouping operations; which are expected to be large, long-running, and highly consumptive of memory and CPU resources.
+
{blank}

* *Eventing*: Supports near real-time handling of changes to data: code can be executed both in response to document-mutations, and as scheduled by timers.
+
{blank}

== Setting Up Services

Services are set up on a per node basis.
Each node can run at most one instance of a service.
The _Data Service_ must run on at least one node.
Some services are interdependent, and therefore require at least one instance of each of their dependencies to be running on the cluster (for example, the _Query Service_ depends on the _Index Service_ and on the _Data Service_).

When the first node in a cluster is initialized, the services assigned to it become the default assignment for each other node subsequently to be added to the cluster.
However, this default can be departed from, node by node; with one or more services omitted from the default, and one or more added.

When first allocated to a node, a service requires the assignment of a specific memory quota, which becomes standard for that service in each of its instances across the cluster.
(The exception to this is the Query Service, which never requires a memory quota.)

Service-allocation should be designed based on workload-analysis: if a particular service is expected to handle a heavy workload, it should be allocated with a larger memory quota, and potentially as the only service on the node.
Alternatively, if a cluster is to be used for development purposes only, it may be convenient to allocate services in the quickest and most convenient way, with some quotas being equal.

For example, the following illustration shows how four services — Data, Index, Query, and Search — might be allocated evenly across the five nodes of a _development_ cluster:

[#cb_cluster_with_services_development]
image::services-and-indexes/services/images/cbClusterWithServicesDevelopment.png[,720,align=left]

This configuration might provide perfectly acceptable performance for each of the four services, in the context of development and testing.
However, if a large amount of data needed, in production, to be intensively indexed, and addressed by means of Query and Search, the following configuration would be more efficient:

[#cb_cluster_with_services_production]
image::services-and-indexes/services/images/cbClusterWithServicesProduction.png[,720,align=left]

In this revised configuration, the Data Service is the only service to run on two of the nodes; the Index Service the only service on two futher nodes; and the Query and Search Services share the fifth and final node.

For a more detailed explanation of service memory quotas, see xref:buckets-memory-and-storage/memory.adoc[Memory].
For information on the practical steps required to initialize a cluster, including the allocation of services to nodes, see xref:install:init-setup.adoc[Initialize the Cluster].
